<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Loan ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø SPA with Sidebar</title>
<style>
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0; padding: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f0f4f8;
    display: flex;
    height: 100vh;
    overflow: hidden;
  }
  nav.sidebar {
    width: 220px;
    background: #2563eb;
    color: white;
    display: flex;
    flex-direction: column;
    padding: 20px 0;
    box-shadow: 2px 0 8px rgba(0,0,0,0.1);
  }
  nav.sidebar button {
    background: #3b82f6;
    border: none;
    color: white;
    padding: 15px 20px;
    margin: 8px 20px;
    border-radius: 12px;
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
    text-align: left;
    transition: background-color 0.3s, transform 0.2s;
  }
  nav.sidebar button:hover {
    background: #1e40af;
    transform: translateX(4px);
    box-shadow: 0 4px 10px rgba(30, 64, 175, 0.5);
  }
  nav.sidebar button.active {
    background: #1e40af;
    box-shadow: 0 6px 15px rgba(30, 64, 175, 0.8);
  }

  main.content {
    flex: 1;
    padding: 30px 40px;
    overflow-y: auto;
    background: white;
    border-radius: 0 15px 15px 0;
    box-shadow: 0 10px 25px rgba(0,0,0,0.07);
  }

  h2 {
    color: #1e3a8a;
    margin-bottom: 20px;
    text-align: center;
  }
  input, button {
    width: 100%;
    padding: 12px;
    margin: 8px 0;
    border-radius: 8px;
    border: 1px solid #cbd5e1;
    font-size: 15px;
    box-sizing: border-box;
    transition: border-color 0.3s;
  }
  input:focus {
    outline: none;
    border-color: #2563eb;
    box-shadow: 0 0 0 3px #93c5fd;
  }
  button {
    background-color: #2563eb;
    color: white;
    border: none;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.2s;
  }
  button:hover {
    background-color: #1d4ed8;
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(37, 99, 235, 0.3);
  }
  .result {
    background: #f0f9ff;
    border-left: 5px solid #0ea5e9;
    padding: 15px;
    margin-top: 15px;
    border-radius: 8px;
    white-space: pre-wrap;
    min-height: 60px;
    font-family: monospace;
  }
  section {
    display: none;
  }
  section.active {
    display: block;
  }

  /* Responsive */
  @media (max-width: 700px) {
    body {
      flex-direction: column;
      height: auto;
    }
    nav.sidebar {
      width: 100%;
      flex-direction: row;
      padding: 10px 0;
      overflow-x: auto;
      box-shadow: none;
      border-radius: 0 0 15px 15px;
    }
    nav.sidebar button {
      flex: 1 0 auto;
      margin: 0 5px;
      text-align: center;
      border-radius: 8px;
      padding: 10px 0;
      font-size: 14px;
    }
    main.content {
      border-radius: 0 0 15px 15px;
      padding: 20px;
      margin-top: 10px;
    }
  }
</style>
</head>
<body>

<nav class="sidebar">
  <button id="nav-add-member" class="active">‚ûï ‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó</button>
  <button id="nav-add-installment">üí∏ ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶¶‡¶ø‡¶®</button>
  <button id="nav-status">üìä ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
  <button id="nav-all-members">üë• ‡¶∏‡¶¨ ‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞</button>
</nav>

<main class="content">

  <section id="add-member" class="active">
    <h2>‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
    <input id="name" placeholder="‡¶®‡¶æ‡¶Æ" />
    <input id="nid" placeholder="NID" />
    <input id="phone" placeholder="‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞" />
    <input id="address" placeholder="‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ" />
    <input id="amount" placeholder="‡¶ã‡¶£‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£" type="number" />
    <input id="weeks" placeholder="‡¶∏‡¶æ‡¶™‡ßç‡¶§‡¶æ‡¶π‡¶ø‡¶ï ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ" type="number" />
    <button onclick="addMember()">‚úÖ ‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>
  </section>

  <section id="add-installment">
    <h2>‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®</h2>
    <input id="memberId" placeholder="Member ID" />
    <input id="weekNo" placeholder="Week No" type="number" />
    <input id="payAmount" placeholder="Amount Paid" type="number" />
    <button onclick="addInstallment()">üí∏ ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®</button>
  </section>

  <section id="status">
    <h2>‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</h2>
    <input id="statusId" placeholder="Member ID" />
    <button onclick="getStatus()">üìä ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
    <div id="output" class="result"></div>
  </section>

  <section id="all-members">
    <h2>‡¶∏‡¶¨ ‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞</h2>
    <button onclick="getAllMembers()">üë• ‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
    <div id="membersList" class="result"></div>
  </section>

</main>

<script>
  const baseURL = ""; // same origin

  const navButtons = document.querySelectorAll("nav.sidebar button");
  const sections = document.querySelectorAll("main.content section");

  navButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      // Remove active from buttons
      navButtons.forEach(b => b.classList.remove("active"));
      btn.classList.add("active");

      // Hide all sections
      sections.forEach(s => s.classList.remove("active"));

      // Show clicked section
      const id = btn.id.replace("nav-", "");
      document.getElementById(id).classList.add("active");

      // Clear outputs
      const out = document.getElementById("output");
      const list = document.getElementById("membersList");
      if(out) out.innerText = "";
      if(list) list.innerText = "";
    });
  });

  async function addMember() {
    const name = document.getElementById("name").value.trim();
    const nid = document.getElementById("nid").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const address = document.getElementById("address").value.trim();
    const amount = document.getElementById("amount").value.trim();
    const weeks = document.getElementById("weeks").value.trim();
    if (!name || !nid || !phone || !amount || !weeks) {
      alert("‡¶∏‡¶¨ ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶®");
      return;
    }
    const res = await fetch(`${baseURL}/add-member?name=${encodeURIComponent(name)}&nid=${encodeURIComponent(nid)}&phone=${encodeURIComponent(phone)}&address=${encodeURIComponent(address)}&amount=${amount}&weeks=${weeks}`);
    const data = await res.json();
    alert(`‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá: ${data.id}`);
    ["name","nid","phone","address","amount","weeks"].forEach(id => document.getElementById(id).value = "");
  }

  async function addInstallment() {
    const memberId = document.getElementById("memberId").value.trim();
    const weekNo = document.getElementById("weekNo").value.trim();
    const amount = document.getElementById("payAmount").value.trim();
    if (!memberId || !weekNo || !amount) {
      alert("‡¶∏‡¶¨ ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶®");
      return;
    }
    const res = await fetch(`${baseURL}/add-installment?memberId=${encodeURIComponent(memberId)}&amount=${amount}&weekNo=${weekNo}`);
    const data = await res.json();
    alert(data.message);
    ["memberId", "weekNo", "payAmount"].forEach(id => document.getElementById(id).value = "");
  }

  async function getStatus() {
    const id = document.getElementById("statusId").value.trim();
    if (!id) {
      alert("Member ID ‡¶¶‡¶ø‡¶®");
      return;
    }
    const res = await fetch(`${baseURL}/status/${encodeURIComponent(id)}`);
    if (res.status !== 200) {
      alert("Member ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø");
      return;
    }
    const data = await res.json();
    document.getElementById("output").innerText = `
‡¶®‡¶æ‡¶Æ: ${data.name}
‡¶ã‡¶£‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£: ${data.loan.amount}
‡¶Æ‡ßã‡¶ü ‡¶´‡ßá‡¶∞‡¶§: ${data.loan.totalPayable}
‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π‡ßá ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø: ${data.loan.weeklyInstallment}
‡¶™‡¶∞‡¶ø‡¶∂‡ßã‡¶ß: ${data.totalPaid}
‡¶¨‡¶æ‡¶ï‡¶ø: ${data.remaining}
`;
  }

  async function getAllMembers() {
    const res = await fetch(`${baseURL}/all-members`);
    const data = await res.json();
    if (!data.length) {
      document.getElementById("membersList").innerText = "‡¶ï‡ßã‡¶® ‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§";
      return;
    }
    let list = "";
    data.forEach(m => {
      list += `‡¶®‡¶æ‡¶Æ: ${m.name}, NID: ${m.nid}, ‡¶´‡ßã‡¶®: ${m.phone}\n`;
    });
    document.getElementById("membersList").innerText = list;
  }
</script>

</body>
</html>
