<!-- Continued from previous index.html -->
        <p><b>ঋণের পরিমাণ:</b> ${data.loan.amount} টাকা</p>
        <p><b>মোট ফেরত:</b> ${data.loan.totalPayable} টাকা</p>
        <p><b>সাপ্তাহিক কিস্তি:</b> ${data.loan.weeklyInstallment} টাকা</p>
        <p><b>পরিশোধিত:</b> ${data.totalPaid} টাকা</p>
        <p><b>বাকি:</b> ${data.remaining} টাকা</p>
        <h4>কিস্তি বিস্তারিত:</h4>
        <ul>
          ${data.installments.map(i => `<li>সপ্তাহ ${i.weekNo}: ${i.amount} টাকা (তারিখ: ${new Date(i.date).toLocaleDateString()})</li>`).join('')}
        </ul>
        <button onclick="fillInstallmentForm(${id}, ${data.loan.weeklyInstallment})">এই মেম্বারের কিস্তি দিন</button>
      `;
      document.getElementById("memberDetailsSection").style.display = "block";
    }

    function closeMemberDetails() {
      document.getElementById("memberDetailsSection").style.display = "none";
    }

    // Compact list page
    async function showCompactMembers() {
      hideAllSections();
      const grid = document.getElementById("compactMembersGrid");
      document.getElementById("memberListCompact").style.display = "block";
      const res = await fetch(`${baseURL}/all-members`);
      const members = await res.json();
      if (members.error) {
        showToast(members.error, false);
        return;
      }
      grid.innerHTML = "";
      members.forEach(m => {
        const box = document.createElement("div");
        box.className = "member-box";
        box.innerHTML = `${m.name}<br>ID: ${m.id}`;
        box.onclick = () => showProfile(m.id);
        grid.appendChild(box);
      });
    }

    async function showProfile(id) {
      hideAllSections();
      const profile = document.getElementById("profileDetails");
      document.getElementById("memberProfile").style.display = "block";
      const res = await fetch(`${baseURL}/status/${id}`);
      const data = await res.json();
      if (data.error) {
        showToast(data.error, false);
        return;
      }
      profile.innerHTML = `
        <h3>${data.name} (ID: ${id})</h3>
        <p><b>ঋণের পরিমাণ:</b> ${data.loan.amount} টাকা</p>
        <p><b>মোট ফেরত:</b> ${data.loan.totalPayable} টাকা</p>
        <p><b>সাপ্তাহিক কিস্তি:</b> ${data.loan.weeklyInstallment} টাকা</p>
        <p><b>পরিশোধিত:</b> ${data.totalPaid} টাকা</p>
        <p><b>বাকি:</b> ${data.remaining} টাকা</p>
        <h4>কিস্তি বিস্তারিত:</h4>
        <ul>
          ${data.installments.map(i => `<li>সপ্তাহ ${i.weekNo}: ${i.amount} টাকা (তারিখ: ${new Date(i.date).toLocaleDateString()})</li>`).join('')}
        </ul>
        <button onclick="fillInstallmentForm(${id}, ${data.loan.weeklyInstallment})">এই মেম্বারের কিস্তি দিন</button>
      `;
    }

    function closeMemberProfile() {
      document.getElementById("memberProfile").style.display = "none";
    }

    function fillInstallmentForm(id, amount) {
      document.getElementById("memberId").value = id;
      document.getElementById("payAmount").value = amount;
      navButtons.forEach((b) => b.classList.remove("active"));
      document.getElementById("nav-add-installment").classList.add("active");
      hideAllSections();
      document.getElementById("add-installment").style.display = "block";
    }
  </script>
</body>
</html>
